function Bar(){function t(t){t.each(function(t){var e=-1===i?this.offsetWidth:i;f.domain(t.map(u)).rangeRoundBands([0,e-a.left-a.right],s);var r=d3.extent(t.map(c));r[0]>0&&(r[0]=0),d.domain(r).range([l-a.top-a.bottom,0]).nice();var o=d3.select(this).selectAll("svg").data([t]),b=o.enter().append("svg").append("g");b.append("g").attr("class","bars"),b.append("g").attr("class","y axis"),b.append("g").attr("class","x axis bottom"),b.append("g").attr("class","x axis zero"),o.attr("width",e).attr("height",l);var A=o.select("g").attr("transform","translate("+a.left+","+a.top+")"),_=o.select(".bars"),T=_.selectAll("g.bar").data(t),k=T.enter().append("g").attr("class","bar");x(k),C(T.transition().duration(v));var S=T.exit().remove();if(w(S),A.select(".x.axis.bottom").attr("transform","translate(0,"+(l-a.top-a.bottom)+")").call(g.orient("bottom")),A.select(".x.axis.zero").attr("transform","translate(0,"+n()+")").call(h.tickFormat("").tickSize(0)),A.select(".y.axis").call(p),A.selectAll(".axis line").attr("style","shape-rendering: crispEdges; stroke: black; fill: none;"),A.selectAll(".axis path").attr("style","shape-rendering: crispEdges; stroke: black; fill: none;"),m){var E;for(E in m)o.selectAll(E).attr("style",m[E])}y&&y(o)})}function e(t){return f(u(t))}function n(){return d(0)}function r(t){return d(c(t))}var o,a={top:30,right:10,bottom:50,left:50},i=-1,l=420,s=.2,u=function(t){return t[0]},c=function(t){return t[1]},f=d3.scale.ordinal(),d=d3.scale.linear(),p=d3.svg.axis().scale(d).orient("left"),h=d3.svg.axis().scale(f),g=d3.svg.axis().scale(f),m=!1,y=!1,v=500,b=!1,x=function(t){t=t.append("rect").attr("class",function(t){return c(t)<0?"negative":"positive"}),b&&t.style("fill",b)},C=function(t){t.select("rect").attr("class",function(t){return c(t)<0?"negative":"positive"}).attr("x",function(t){return e(t)}).attr("y",function(t){return c(t)<0?n():r(t)}).attr("width",f.rangeBand()).attr("height",function(t){return Math.abs(r(t)-n())})},w=function(){};return t.margin=function(e){return arguments.length?(a.top="undefined"!=typeof e.top?e.top:a.top,a.right="undefined"!=typeof e.right?e.right:a.right,a.bottom="undefined"!=typeof e.bottom?e.bottom:a.bottom,a.left="undefined"!=typeof e.left?e.left:a.left,t):a},t.duration=function(e){return arguments.length?(v=e,t):v},t.xRoundBands=function(e){return arguments.length?(s=e,t):s},t.width=function(e){return arguments.length?(i=e,t):i},t.height=function(e){return arguments.length?(l=e,t):l},t.x=function(e){return arguments.length?(u=e,t):u},t.y=function(e){return arguments.length?(c=e,t):c},t.barEnter=function(e){return arguments.length?(x=e,t):x},t.barUpdate=function(e){return arguments.length?(C=e,t):C},t.barExit=function(e){return arguments.length?(w=e,t):w},t.colorize=function(e){return arguments.length?(b=e,t):b},t.style=function(e){return arguments.length?(m=e,t):m},t.updated=function(e){return arguments.length?(y=e,t):y},t.update=function(){o.transition().duration(v).call(t)},t}function Line(){function t(t){t.each(function(t){var o=-1===n?this.offsetWidth:n;t[0]instanceof Array||(t=[t]),l.domain([0,d3.max(t,function(t){return t.length-1})]).range([0,o-e.left-e.right]);var a=[d3.min(t,function(t){return d3.min(t,i)}),d3.max(t,function(t){return d3.max(t,i)})];s.domain(a).range([r-e.top-e.bottom,0]).nice();var f=d3.select(this).selectAll("svg").data([t]),d=f.enter().append("svg").append("g");d.append("g").attr("class","series"),d.append("g").attr("class","y axis"),d.append("g").attr("class","x axis bottom"),d.append("g").attr("class","x axis zero"),f.attr("width",o).attr("height",r);var p=f.select("g").attr("transform","translate("+e.left+","+e.top+")"),b=f.select(".series").selectAll("g.line").data(t),x=b.enter().append("g").classed("line",!0);if(h(x),g(b),m(b.exit().remove()),p.select(".x.axis.bottom").attr("transform","translate(0,"+(r-e.top-e.bottom)+")").call(c),p.select(".y.axis").call(u),p.selectAll(".axis line").attr("style","shape-rendering: crispEdges; stroke: black; fill: none;"),p.selectAll(".axis path").attr("style","shape-rendering: crispEdges; stroke: black; fill: none;"),y){var C;for(C in y)f.selectAll(C).attr("style",y[C])}v&&v(f)})}var e={top:30,right:10,bottom:50,left:50},n=-1,r=420,o=500,a=function(t){return t[0]},i=function(t){return t[1]},l=d3.scale.linear(),s=d3.scale.linear(),u=d3.svg.axis().scale(s).orient("left"),c=d3.svg.axis().scale(l).orient("bottom"),f=function(t){return t.text||""},d=function(t){return i(t)},p=d3.svg.line().x(function(t,e){return l(e)}).y(function(t){return s(i(t))}),h=function(t){t.append("path").classed("line",!0).style({fill:"none",stroke:b||"black"}).attr("d",d3.svg.line().x(function(t,e){return l(e)}).y(r))},g=function(t){t.select(".line").attr("d",p);{var n=t.selectAll(".point").data(function(t){return t});n.enter().append("circle").classed("point",!0).style({fill:b||"black",stroke:b||"black"}).attr("transform",function(t,n){return"translate("+l(n)+", "+(r+e.top)+")"}).attr("r",4),t.selectAll(".point").attr("transform",function(t,e){return"translate("+l(e)+", "+s(i(t))+")"})}},m=function(){},y=!1,v=!1,b=!1;return t.width=function(e){return arguments.length?(n=e,t):n},t.height=function(e){return arguments.length?(r=e,t):r},t.x=function(e){return arguments.length?(a=e,t):a},t.y=function(e){return arguments.length?(i=e,t):i},t.xScale=function(e){return arguments.length?(l=e,t):l},t.yScale=function(e){return arguments.length?(s=e,t):s},t.colorize=function(e){return arguments.length?(b=e,t):b},t.text=function(e){return arguments.length?(f=e,t):f},t.value=function(e){return arguments.length?(d=e,t):d},t.duration=function(e){return arguments.length?(o=e,t):o},t.margin=function(n){return arguments.length?(e.top="undefined"!=typeof n.top?n.top:e.top,e.right="undefined"!=typeof n.right?n.right:e.right,e.bottom="undefined"!=typeof n.bottom?n.bottom:e.bottom,e.left="undefined"!=typeof n.left?n.left:e.left,t):e},t.updated=function(e){return arguments.length?(v=e,t):v},t}!function(t){var e=function(){var t="string",e=function(t){return typeof t}(),n=function(r){var o=this,a=typeof r,i=function(t){return t};if(r=r.trim(),null===r)return i;if(a===e)return i;if(a===t){var l;if(""===r)return i;if(r.match(/[-=]>/g)){if("->"===r.substr(0,2))return l=new Function(n.selfSymbol,r.substr(2)),function(){return l.apply(o,arguments)};var s=r.match(/^[(\s]*([^()]*?)[)\s]*=>(.*)/);return l=new Function(s[1],"return "+s[2]),function(){return l.apply(o,arguments)}}return l=new Function(n.selfSymbol,"return "+r),function(){return l.apply(o,arguments)}}return r};return n.selfSymbol="d",n}(),n=t.applyChartConfiguration=function(t,n,r,o){var a,i=new RegExp("^data-"+t+"-"),l={},s=[],u=n.attributes,c=u.length;for(n.immediates=o,n.chart=r,a=0;c>a;a++){var f,d=u.item(a).nodeName;if(d.match(i)){d=d.replace(i,""),f=u.item(a).nodeValue,s.push(d);try{l[d]={src:f,f:e(f)}}catch(p){l[d]={src:f,f:null}}}}for(a=0;c>a;a++)d=s[a],"function"==typeof r[d]&&r[d](o.indexOf(d)>-1?l[d].f():l[d].f)};t.getChartPropertyValues=function(t){var e,n,r,o=t.controller?t.controller:t,a=o.chart?o.chart:o,i=/data-[^-]*-(.*)$/,l=Object.keys(a).reduce(function(t,n){if("update"!==n&&"function"==typeof a[n])try{e=a[n](),t[n]="function"==typeof e?"":e}catch(r){"undefined"!=typeof console&&(console.log(n),console.log(a[n]),console.error(r))}return t},{}),s=t.attributes||[],u=s.length;for(n=0;u>n;n++){r=s.item(n);var c=(i.exec(r.nodeName)||[])[1];c&&(l[c]=r.nodeValue)}return l},t.getChartProperties=function(t){var e=t.controller?t.controller:t,n=e.chart?e.chart:e;return Object.keys(n).reduce(function(t,e){return"update"!==e&&"function"==typeof n[e]&&t.push(e),t},[])},t.setChartProperty=function(t,e,r,o){var a=t.controller,i=a.dataAttributePrefix||"chart";console.log("data-"+i+"-"+e,t),t.setAttribute("data-"+i+"-"+e,r),n(i,t,t.chart,t.immediates),a.update(o)},t.getChartProperty=function(t,e){var n,r=t.controller,o=r.chart,a=t.attributes,i=a.length,l=new RegExp("data-[^-]*-"+e+"$");for(n=0;i>n;n++){var s=a.item(n).nodeName;if(s.match(l))return a.item(n).nodeValue}return(o[e]||function(){})()}}(this);var ControllerNotFoundException=function(t){var e=this;e.name="ControllerNotFoundException",e.message='Controller "'+t+'" not registered'};ControllerNotFoundException.prototype=Object.create(Error.prototype);var Controllers=function(){this._controllers={}};Controllers.prototype.create=function(t,e,n){var r=this._controllers[e];if(!r)throw new ControllerNotFoundException(e);return t.controller=new r(t,n)},Controllers.prototype.register=function(t,e){this._controllers[t]=e};var cleanupControllers=function(t){var e=function(t){if(t&&t.children){var n,r,o=t.children.length;for(n=0;o>n;n++)r=t.children[n],e(r)}t.controller&&(t.controller.teardown&&t.controller.teardown(),delete t.controller)};if("DOMNodeRemoved"==t.type){var n=t.target;e(n)}};document.body.addEventListener("DOMNodeRemoved",cleanupControllers,!0),function(t){var e,n=0,r=t.handlebarsHelpers={JSONstringify:function(t){return JSON.stringify(t,null,"  ")},limit:function(t,e,n){if(!t||0==t.length)return n.inverse(this);for(var r=[],o=0;e>o&&o<t.length;++o)r.push(n.fn(t[o]));return r.join("")},isComplex:function(t){return"object"==typeof t?!0:!1},ifComplex:function(t,e){return"object"==typeof t?e.fn(this):e.inverse(this)},notPrivate:function(t,e){var n,r={};for(n in t)"_"!==n.substr(0,1)&&(r[n]=t[n]);return e.fn(r)},keys:function(t,e){return e.fn(Object.keys(t))},eachKeys:function(t,e){var n=Object.keys(t||{}),r="";return n.forEach(function(n){r+=e.fn({key:n,value:t[n]})}),r},getval:function(t,e,n){return t[e]||n||""},properCase:function(t){var e=(t||"").replace(/([A-Z])/g," $1"),n=e.charAt(0).toUpperCase()+e.slice(1);return n},embed:function(t,e){var r="component_"+n++,o=el("#"+t).getAttribute("data-controller");if(o){var a='<div id="'+r+'"></div>';setTimeout(function(e,n,r){return function(){var o=el("#"+e);controllers.create(o,n,{data:r,template:el("#"+t).innerHTML})}}(r,o,e),10)}else a=template(e,{helpers:handlebarsHelpers});return new Handlebars.SafeString(a)},qrcode:function(t,e){var r="component_"+n++;return setTimeout(function(n){return function(){var r=new QRCode(n,{width:e,height:e});r.makeCode(t)}}(r),10),new Handlebars.SafeString('<div id="'+r+'"></div>')},log:function(t){console.log(t)},moment:function(t,e){return moment(t).format(e)}};for(e in Handlebars.helpers)r[e]=r[e]||Handlebars.helpers[e]}(this),{define:"undefined"!=typeof define?define:function(t,e){"undefined"!=typeof module?module.exports=e():window.Loader=e()}}.define([],function(){var t={},e=[],n=[];t.dataTypes={json:"application/json",jsonp:"application/json"};var r=function(t,r){var o=e.indexOf(t),a=o>-1;return a||(o=e.length,e[o]=t,n[o]=[]),n[o].push(r),a},o=function(t,r,o){var a,i,l,s=e.indexOf(t);if(s>-1)for(a=(n.splice(s,1)||[])[0]||[],e.splice(s,1),l=a.length,i=0;l>i;i++)a[i](r,o)},a=function(){var t=["Msxml2.XMLHTTP","Microsoft.XMLHTTP"];if(window.ActiveXObject)for(var e=0;e<t.length;e++)try{return new ActiveXObject(t[e])}catch(n){}else if(window.XMLHttpRequest)return new XMLHttpRequest;return!1},i=function(t){var e,n,r,o=[],a=function(t,e){e=e instanceof Function?e():null===e?"":e,o[o.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(t instanceof Array)for(r=t.length,n=0;r>n;n++)a(t[n].name,t[n].value);else if(t)for(e in t)a(e,t[e]);return o.join("&").replace(/%20/g,"+")},l=function(e){t[e]=function(n,l,s){var u,c,f,d,p,h,g=n;if("function"==typeof l&&(s=l,l={}),s=s||function(){},l=l||{},"string"==typeof l.uri)try{l.uri=JSON.parse(l.uri)}catch(m){}if(l.uri=l.uri||{},u=n+JSON.stringify(l.uri)+JSON.stringify(l.data),!r(u,s))if(l.uri.ts=new Date,g+=(-1===(g||"").indexOf("?")?"?":"&")+i(l.uri),c=new a,c.onreadystatechange=function(){if(4===c.readyState)if(200===c.status||-1===window.location.href.indexOf("http")){try{f=JSON.parse(c.responseText)}catch(t){f=c.responseText}if(f.error||f.errors)o(u,f);else{d=f[f.root];try{f=d instanceof Array?{items:d,offset:f.offset,limit:f.limit,count:f.count,length:d.length}:d||f}catch(t){}o(u,null,f)}}else{var e=new Error(c.statusText+": "+(c.responseText||c.response));e.type=c.statusText,e.code=c.status,e.requestObject=c,o(u,e)}},c.open(e.toUpperCase(),g,!0),l.data){if(h=t.dataTypes[l.dataType]||l.dataType||"application/json",l.data instanceof FormData)p=l.data;else{c.setRequestHeader("Content-type",h);try{p=JSON.stringify(l.data)}catch(m){p=l.body}}l.headers&&!function(){var t;for(t in l.headers)try{c.setRequestHeader(t,l.headers[t])}catch(e){}}(),c.send(p)}else c.send(null)}};return t.postForm=function(t,e){var n=new FormData(t),i=t.action+(new Date).getTime();if(!r(i,e)){var l=new a;l.onreadystatechange=function(){if(4===l.readyState)if(200===l.status||-1===window.location.href.indexOf("http")){try{response=JSON.parse(l.responseText)}catch(t){response=l.responseText}if(response.error||response.errors)o(i,response);else{items=response[response.root];try{response=items instanceof Array?{items:items,offset:response.offset,limit:response.limit,count:response.count,length:items.length}:items||response}catch(t){}o(i,null,response)}}else{var e=new Error(l.statusText+": "+(l.responseText||l.response));e.type=l.statusText,e.code=l.status,e.requestObject=l,o(i,e)}},l.open("POST",t.action,!0),l.send(n)}return!1},function(t,e){var n,r=t.length;for(n=0;r>n;n++)e(t[n])}(["get","post","put","delete"],l),t}),function(t){var e=t.Partials=function(t){var e=this;e.options=t,e.options.ext=e.options.ext||".html",e.options.path=e.options.path||"/partials/"};e.prototype.set=function(t,e){var n=el("#"+t);n||(n=document.createElement("script"),n.setAttribute("type","text/x-template"),n.setAttribute("id",t),document.getElementsByTagName("head").item(0).appendChild(n)),n.innerHTML=e,Handlebars.registerPartial(t,Handlebars.compile(e))},e.prototype.get=function(t,e){var n=this,r=el("#"+t);if(r||(r=document.createElement("script"),r.setAttribute("type","text/x-template"),r.setAttribute("id",t),document.getElementsByTagName("head").item(0).appendChild(r)),r.innerHTML)try{Handlebars.partials[t]||n.set(t,r.innerHTML),e(null,Handlebars.partials[t])}catch(o){e(o,Handlebars.partials[t])}else Loader.get(n.options.path+t+n.options.ext,function(o,a){if(o)return e(o);r.innerHTML=a;try{n.set(t,r.innerHTML),e(null,Handlebars.partials[t])}catch(i){e(i,Handlebars.partials[t])}})},e.prototype.preload=function(t){var e=this,n=1,r=function(){n--,1>n&&setTimeout(t,1)};els('[type="text/x-template"]').forEach(function(t){var o=t.getAttribute("id");n++,e.get(o,r)}),r()}}(this);var Record=function(t){{var e=this;e.keys=new Array}e._listeners={},e._data=t};Record.prototype.on=function(t,e){self._listeners[t]=self._listeners[t]||[],self._listeners[t].push(e)},Record.prototype.off=function(t,e){var n=!1;if(self._listeners[t]instanceof Array)if(e){var r,o=self._listeners[t].length;for(r=o;r>-1;--r)self._listeners[t][r]===e&&(self._listeners[t].splice(r,1),n=!0)}else delete self._listeners[t],self._listeners[t]=!1,n=!0;return n},Record.prototype.handle=function(t,e){var n,r=this,o=r._listeners[t]||[],a=o.length;for(n=0;a>n;n++)o[n].call(r,e)},Record.prototype.raw=function(){var t=this;return t._data},Record.prototype.get=function(t){var e=this;return e._data[t]},Record.prototype.set=function(t,e){var n=this;return n._data[t]=e,n.handle("updated",t),e},Record.prototype.remove=function(t){var e=this;return delete e._data[t],e.handle("removed",t),value},Record.prototype.update=function(t){var e,n=this;for(e in t)n._data[e]=t[e];n.handle("updated")},Record.prototype.toString=function(){var t=this;return JSON.stringify(t._data)};var Store=function(t){var e=this;e.records=new Array,e._updates=0,e._listeners={},e.options=t||{}};Store.prototype.on=function(t,e){self._listeners[t]=self._listeners[t]||[],self._listeners[t].push(e)},Store.prototype.off=function(t,e){var n=!1;if(self._listeners[t]instanceof Array)if(e){var r,o=self._listeners[t].length;for(r=o;r>-1;--r)self._listeners[t][r]===e&&(self._listeners[t].splice(r,1),n=!0)}else delete self._listeners[t],self._listeners[t]=!1,n=!0;return n},Store.prototype.handle=function(t,e){var n,r=this,o=r._listeners[t]||[],a=o.length;for(n=0;a>n;n++)o[n].call(r,e)},Store.prototype.beginUpdate=function(){var t=this;t._updates++},Store.prototype.endUpdate=function(){var t=this;t._updates&&(t._updates--,0==t._updates&&t.handle("updated"))},Store.prototype.insert=function(t){var e=this,n=new Record(t);e.records.push(n),e.handle("inserted",n)},Store.prototype.find=function(t){var e=this;return sift(t,e.records)},Store.prototype.get=function(t){var e=this,n=e.find({_id:t});return n.length?n[0]:!1},Store.prototype.update=function(t,e){var n=this;return void 0===e&&(t=e._id||e.name),e._id=t||e._id||e.name,(record=n.get(t))?(record.update(e),!0):!1},Store.prototype.upsert=function(t){var e=this;return e.update(t._id,t)||e.insert(t),e},function(t){t.el=function(t,e){return e||(e=t,t=document),t.querySelector(e)},t.els=function(t,e){return e||(e=t,t=document),Array.prototype.slice.call(t.querySelectorAll(e))},t.val=function(t){return t.value||t.getAttribute("value")||t.innerText||t.innerHTML},t.pkg=function(t){var e={};return t.forEach(function(t){e[t.getAttribute("name")]=val(t)}),e}}(this);var MindMap=function(){"use strict";var t={top:20,left:120,bottom:20,right:120},e=-1,n=500,r=500,o="_id",a=function(){},i=function(t){return t.name},l=1,s=!1,u=!1,c=function(t){t.append("svg:circle").attr("r",1e-6),t.append("svg:text").attr("text-anchor","middle").attr("dy",14).text(i).style("fill-opacity",1)},f=function(t){t.select("text").text(i),t.select("circle").attr("r",4.5)},d=function(t){t.select("circle").attr("r",1e-6),t.select("text").style("fill-opacity",1e-6)},p=MindMap.elbow,h=function(i){i.each(function(i){var g=-1===e?this.offsetWidth:e,m=g-t.left-t.right,y=n-t.top-t.bottom,v=d3.select(this),b=d3.select(this).select("svg");b[0][0]||(b=d3.select(this).append("svg")),b.attr("width",g).attr("height",n);var x=b.select("g");b=x[0][0]?x:b.append("svg:g"),b=b.attr("transform","translate("+(m/2+t.left)+","+t.top+")"),i.x0=y/2,i.y0=0;var C=d3.layout.tree().size([y,m]);if(h.update=function(){v.transition().duration(r).call(h)},!i.left&&!i.right){var w=0,A=(i.children||[]).length;for(i.left=[],i.right=[];A>w;w++)w%2?(i.left.push(i.children[w]),i.children[w].position="left"):(i.right.push(i.children[w]),i.children[w].position="right")}var _=C.size([y,m/2-20]).children(function(t){return 0===t.depth?t.left:t.children}).nodes(i).reverse(),T=C.size([y,m/2]).children(function(t){return 0===t.depth?t.right:t.children}).nodes(i).reverse();i.children=i.left.concat(i.right);var k=window.nodes=function(t,e){var n=e[e.length-1];return t.pop(),t.forEach(function(t){t.y=-t.y,t.parent=n,t.position="left"}),e.forEach(function(t){t.position="right"}),n.position="root",t.concat(e)}(_,T),S=b.selectAll("g.node").data(k,function(t){return t[o]||(t[o]=++l)}),E=S.enter().append("svg:g").attr("class","node").attr("position",function(t){return t.position}).attr("transform",function(){return"translate("+i.y0+","+i.x0+")"}).on("click",a);c(E);var M=S.transition().duration(r).attr("transform",function(t){return"translate("+t.y+","+t.x+")"});f(M);var H=S.exit().transition().duration(r).attr("transform",function(){return"translate("+i.y+","+i.x+")"}).remove();d(H);var N=b.selectAll("path.link").data(C.links(k),function(t){return t.target[o]});if(N.enter().insert("svg:path","g").attr("class","link").attr("d",function(){var t={x:i.x0,y:i.y0};return p({source:t,target:t})}).style({fill:"none",stroke:"#ccc","stroke-width":"1.5px"}).transition().duration(r).attr("d",p),N.transition().duration(r).attr("d",p),N.exit().transition().duration(r).attr("d",function(){var t={x:i.x,y:i.y};return p({source:t,target:t})}).remove(),k.forEach(function(t){t.x0=t.x,t.y0=t.y}),s){var O;for(O in s)b.selectAll(O).attr("style",s[O])}u&&u(b)})};return h.width=function(t){return arguments.length?(e=t,h):e},h.height=function(t){return arguments.length?(n=t,h):n},h.duration=function(t){return arguments.length?(r=t,h):r},h.connector=function(t){return arguments.length?(p=t,h):p},h.click=function(t){return arguments.length?(a=t,h):a},h.identity=function(t){return arguments.length?(o=t,h):o},h.text=function(t){return arguments.length?(i=t,h):i},h.nodeEnter=function(t){return arguments.length?(c=t,h):c},h.nodeUpdate=function(t){return arguments.length?(f=t,h):f},h.nodeExit=function(t){return arguments.length?(d=t,h):d},h.style=function(t){return arguments.length?(s=t,h):s},h.updated=function(t){return arguments.length?(u=t,h):u},h.margin=function(e){return arguments.length?(t.top="undefined"!=typeof e.top?e.top:t.top,t.right="undefined"!=typeof e.right?e.right:t.right,t.bottom="undefined"!=typeof e.bottom?e.bottom:t.bottom,t.left="undefined"!=typeof e.left?e.left:t.left,h):t},h};MindMap.elbow=function(t){var e=t.source,n=t.target,r=(n.y-e.y)/2;return"M"+e.y+","+e.x+"H"+(e.y+r)+"V"+n.x+"H"+n.y},MindMap.loadFreeMind=function(t,e){d3.xml(t,"application/xml",function(t,n){var r=function(t){var e={};if(1==t.nodeType){if(t.attributes.length>0){e["@attributes"]={};for(var n=0;n<t.attributes.length;n++){var o=t.attributes.item(n);e["@attributes"][o.nodeName]=o.nodeValue}}}else 3==t.nodeType&&(e=t.nodeValue);if(t.hasChildNodes())for(var a=0;a<t.childNodes.length;a++){var i=t.childNodes.item(a),l=i.nodeName;if("undefined"==typeof e[l])e[l]=r(i);else{if("undefined"==typeof e[l].push){var s=e[l];e[l]=[],e[l].push(s)}e[l].push(r(i))}}return e},o=r(n),a=o.map.node,i=function(t,e){var n,r,o,a,l=e,s={};for(n in t["@attributes"])s[n.toLowerCase()]=t["@attributes"][n];if(s.direction=s.direction||l,o=(t.node||[]).length)for(s.children=[],r=0;o>r;r++)l=t.node[r]["@attributes"].POSITION||l,a=i(t.node[r],{},l),(s[l]=s[l]||[]).push(a),s.children.push(a);return s},l=i(a,"right");return e(t,l)})};var Pie=function(){var t,e={top:20,left:50,bottom:20,right:20},n=-1,r=500,o=500,a="_id",i=1,l=0,s=!1,u=!1,c=function(t){return+t.value},f=!1,d=function(t){return f(c(t))},p=function(t){return t.text||""},h=function(t){return t.data[a]||(t.data[a]=++i)},g=function(t,e){t.append("path").style("fill",function(t){return d(t.data)}),t.append("text").attr("transform",function(t){return"translate("+e.centroid(t)+")"}).attr("dy",".35em").style("text-anchor","middle").text(function(t){return p(t.data)})},m=function(t,e){t.select("path").style("fill",function(t){return d(t.data)}).attrTween("d",function(t){this._current=this._current||t;var n=d3.interpolate(this._current,t);return this._current=n(0),function(t){return e(n(t))}}),t.select("text").attr("transform",function(t){return"translate("+e.centroid(t)+")"}).text(function(t){return p(t.data)})},y=function(){},v=function(d){t=d,d.each(function(t){for(var d=-1===n?this.offsetWidth:n,p=d-e.left-e.right,v=r-e.top-e.bottom,b=Math.floor(p>v?v/2:p/2),x=d3.select(this).select("svg"),C=d3.min(t,c),w=d3.max(t,c),A=0,_=t.length;_>A;A++)t[A][a]=t[A][a]||i++;f=d3.scale.linear().domain([C,w]).range(["#ddd","#333"]),x[0][0]||(x=d3.select(this).append("svg")),x.attr("width",d).attr("height",r);var T=d3.svg.arc().outerRadius(b).innerRadius(l),k=d3.layout.pie().value(c),S=x.select("g"),E=S.select(".slices");S[0][0]||(S=x.append("g"),E=S.append("g").attr("class","slices")),S.attr("transform","translate("+(e.left+p/2)+", "+(e.top+v/2)+")");var M=E.selectAll("g.slice").data(k(t,h)),H=M.enter().append("g").attr("class","slice");g(H,T),m(M.transition().duration(o),T);var N=M.exit().remove();if(y(N),s){var O;for(O in s)x.selectAll(O).attr("style",s[O])}u&&u(x)})};return v.width=function(t){return arguments.length?(n=t,v):n},v.height=function(t){return arguments.length?(r=t,v):r},v.value=function(t){return arguments.length?(c=t,v):c},v.text=function(t){return arguments.length?(p=t,v):p},v.duration=function(t){return arguments.length?(o=t,v):o},v.identity=function(t){return arguments.length?(a=t,v):a},v.innerRadius=function(t){return arguments.length?(l=t,v):l},v.style=function(t){return arguments.length?(s=t,v):s},v.margin=function(t){return arguments.length?(e.top="undefined"!=typeof t.top?t.top:e.top,e.right="undefined"!=typeof t.right?t.right:e.right,e.bottom="undefined"!=typeof t.bottom?t.bottom:e.bottom,e.left="undefined"!=typeof t.left?t.left:e.left,v):e},v.updated=function(t){return arguments.length?(u=t,v):u},v.colorize=function(t){return arguments.length?(d=t,v):d},v.refresh=function(){},v.update=function(){t.transition().duration(o).call(v)},v},Scatter=function(){var t={top:20,left:50,bottom:20,right:20},e=-1,n=500,r=500,o=!0,a=!0,i="_id",l=1,s=!1,u=!1,c=!1,f=function(t){return t.x},d=function(t){return t.y},p=function(){return 8},h=function(t,e){var n=d3.min(t,f),r=d3.max(t,f),o=.1*(r-n)||1;return n-=o,r+=o,d3.scale.linear().domain([n,r]).range([0,e])},g=function(t,e){var n=d3.min(t,d),r=d3.max(t,d),o=.1*(r-n)||1;return n-=o,r+=o,d3.scale.linear().domain([r,n]).range([0,e])},c=function(){return"black"},m=function(t){return t.text||""},y=function(t){var e=t.append("svg:circle").attr("r",1e-6);c&&e.style("fill",c),t.append("svg:text").attr("text-anchor","middle").attr("dy",function(t){return-p(t)-3}).text(m).style("fill-opacity",1)},v=function(t){t.select("text").text(m),t.select("circle").attr("r",p)},b=function(t){t.select("circle").attr("r",1e-6),t.select("text").style("fill-opacity",1e-6)},x=function(c){c.each(function(c){var p=-1===e?this.offsetWidth:e,m=p-t.left-t.right,x=n-t.top-t.bottom,C=d3.select(this).select("svg"),w=h(c,m),A=g(c,x);if(o)var _=d3.svg.axis().scale(w).orient("bottom");if(a)var T=d3.svg.axis().scale(A).orient("left");C[0][0]||(C=d3.select(this).append("svg")),C.attr("width",p).attr("height",n);var k=C.selectAll("g.node").data(c,function(t){return t[i]||(t[i]=++l)}),S=k.enter().append("svg:g").attr("class","node").attr("transform",function(e,n){return"translate("+(w(f(e,n))+t.left)+","+(t.top+x)+")"});y(S);var E=k.transition().duration(r).attr("transform",function(e,n){return"translate("+(w(f(e,n))+t.left)+", "+(A(d(e,n))+t.top)+")"});v(E);var M=k.exit().transition().duration(r).attr("transform",function(e,n){return"translate("+(w(f(e,n))+t.left)+", "+(t.top+x)+")"}).remove();if(b(M),o){var H=C.select("g.xAxis");H[0][0]?H.transition().duration(r).call(_):H=C.append("g").attr("class","axis xAxis").attr("transform","translate("+t.left+","+(x+t.top)+")").call(_),H.selectAll("line").attr("style","shape-rendering: crispEdges; stroke: black; fill: none;"),H.selectAll("path").attr("style","shape-rendering: crispEdges; stroke: black; fill: none;")}if(a){var N=C.select("g.yAxis");N[0][0]?N.transition().duration(r).call(T):N=C.append("g").attr("class","axis yAxis").attr("transform","translate("+t.left+","+t.top+")").call(T),N.selectAll("line").attr("style","shape-rendering: crispEdges; stroke: black; fill: none;"),N.selectAll("path").attr("style","shape-rendering: crispEdges; stroke: black; fill: none;")}if(s){var O;for(O in s)C.selectAll(O).attr("style",s[O])}u&&u(C)})};return x.width=function(t){return arguments.length?(e=t,x):e},x.height=function(t){return arguments.length?(n=t,x):n},x.x=function(t){return arguments.length?(f=t,x):f},x.y=function(t){return arguments.length?(d=t,x):d},x.text=function(t){return arguments.length?(m=t,x):m},x.size=function(t){return arguments.length?(p="function"==typeof t?t:function(){return t},x):p},x.duration=function(t){return arguments.length?(r=t,x):r},x.identity=function(t){return arguments.length?(i=t,x):i},x.style=function(t){return arguments.length?(s=t,x):s},x.xAxis=function(t){return arguments.length?(o=!!t,x):o},x.yAxis=function(t){return arguments.length?(a=!!t,x):a},x.scaleX=function(t){return arguments.length?(h=t,x):h},x.scaleY=function(t){return arguments.length?(g=t,x):g},x.nodeEnter=function(t){return arguments.length?(y=t,x):y},x.nodeUpdate=function(t){return arguments.length?(v=t,x):v},x.nodeExit=function(t){return arguments.length?(b=t,x):b},x.colorize=function(t){return arguments.length?(c=t,x):c},x.margin=function(e){return arguments.length?(t.top="undefined"!=typeof e.top?e.top:t.top,t.right="undefined"!=typeof e.right?e.right:t.right,t.bottom="undefined"!=typeof e.bottom?e.bottom:t.bottom,t.left="undefined"!=typeof e.left?e.left:t.left,x):t},x.updated=function(t){return arguments.length?(u=t,x):u},x},Table=function(){var t=-1,e=-1,n="_id",r=1,o=500,a=!1,i=!1,l=[],s=function(){},u=function(t){t.html(function(t){var e=this.parentNode.__data__,n=t.value||t;return"function"==typeof n?n(e):e[n]})},c=function(){},f=function(){},d=function(t){t.text(function(t){return t.title||t.value||t})},p=function(){},h=function(o){o.each(function(o){var h=l,g=d3.select(this).select("table"),m=g.select("thead");tbody=g.select("tbody");for(var y=0,v=o.length;v>y;y++)o[y][n]=o[y][n]||r++;g[0][0]||(g=d3.select(this).append("table"),g.attr("cellspacing",0).attr("cellpadding",0),m=g.append("thead"),tbody=g.append("tbody")),t>-1&&g.attr("width",t),e>-1&&g.attr("height",e),0===h.length&&o.length&&(h=Object.keys(o[0]));var b=m.select("tr");b[0][0]||(b=m.append("tr"));var b=b.selectAll("th").data(h),x=b.enter().append("th");f(x,h),d(b,h),p(b.exit().remove(),h);var C=tbody.selectAll("tr").data(o);C.enter().append("tr");var w=C.selectAll("td").data(h),A=w.enter().append("td");if(s(A,h),u(w,h),c(C.exit().remove().selectAll("td"),h),a){var _;for(_ in a)g.selectAll(_).attr("style",a[_])}i&&i(g)})};return h.width=function(e){return arguments.length?(t=e,h):t},h.height=function(t){return arguments.length?(e=t,h):e},h.identity=function(t){return arguments.length?(n=t,h):n},h.cols=function(t){return arguments.length?(l=t,h):l},h.duration=function(t){return arguments.length?(o=t,h):o},h.style=function(t){return arguments.length?(a=t,h):a},h.updated=function(t){return arguments.length?(i=t,h):i},h.cellEnter=function(t){return arguments.length?(s=t,h):s},h.cellUpdate=function(t){return arguments.length?(u=t,h):u},h.cellExit=function(t){return arguments.length?(c=t,h):c},h.update=function(){container.transition().duration(o).call(h)},h},controllers=controllers||new Controllers,ChartInspectorController=function(t){var e,n,r=this,o=els(t,"[data-template-property]")||{},a=r.templates={},i=o.length,l=els("[data-controller$=Chart],[data-controller$=View]");for(r.container=t,e=0;i>e;e++)n=o[e].attributes["data-template-property"].nodeValue,a[n]=Handlebars.compile(o[e].innerHTML);l.forEach(function(t){var e=document.createElement("button");e.setAttribute("title","Configure Chart"),e.style.float="right",e.style.cursor="pointer",e.setAttribute("class","ink-button btn-configure"),e.innerHTML='<i class="fa fa-gear" />',r.bindEditClick(e,t),t.appendChild(e)})};ChartInspectorController.prototype.bindEditClick=function(t,e){var n=this;t&&!e&&(e=t),t.onclick=function(){return n.inspect(e),!1}},ChartInspectorController.prototype.inspect=function(t){var e,n,r,o,a,i=this,l=getChartPropertyValues(t),s=el(i.container,"[data-properties]")||container,u="";i._checkEditors&&clearTimeout(i._checkEditors),s.innerHTML="";for(e in l)n=l[e],a=typeof n,o=i.templates[e]||i.templates[a],o||"boolean"!==a||(n=""+n),o=o||i.templates.default,r=o({propertyName:e,propertyValue:n},{helpers:handlebarsHelpers}),u+=r;s.innerHTML=u,els(s,"textarea.codemirror").forEach(function(t){CodeMirror.fromTextArea(t,{lineNumbers:!0})});var c=function(){var e=els(s,".property-editor"),n=t;i._checkEditors=!1,e.forEach(function(t){var e=t.name,r=t.value,o=l[e],a=typeof o,i=["object","boolean","number"].indexOf(a)>-1;if("undefined"===a&&(o="",console.log(e,i,o,r,r!=o)),i){o=JSON.stringify(o);try{r=JSON.stringify(new Function("return "+r)())}catch(s){}}r!=o&&(console.log(e,o+"=>"+r,typeof o+"=>"+typeof r),l[e]=r,setChartProperty(n,e,r))}),i._checkEditors=setTimeout(c,100)};c()},ChartInspectorController.prototype.teardown=function(){var t=this;t._checkEditors&&clearTimeout(t._checkEditors),delete t.container,t.container=null},controllers.register("ChartInspector",ChartInspectorController);var controllers=controllers||new Controllers,MarkdownController=function(t){var e=t.innerHTML;t.innerHTML=markdown.toHTML(e)};controllers.register("MarkdownController",MarkdownController);
var controllers=controllers||new Controllers,SourceTypeController=function(t){var e=this;e.container=t,t.onchange=function(){e.show(t.value)},e.show(t.value)};SourceTypeController.prototype.show=function(t){var e,n=this,r=els(n.container.parentNode.parentNode,"label.source-type"),o=r.length;for(e=0;o>e;e++)r[e].style.display="none";for(r=els(n.container.parentNode.parentNode,"label.source-type."+t),o=r.length,e=0;o>e;e++)r[e].style.display=""},controllers.register("SourceTypeController",SourceTypeController);var ExecuteSourceController=function(t){var e=function(t){if(t){var e,n=els(".vis-chart-output"),r=n.length;for(e=0;r>e;e++)n[e].controller.update(t)}};t.onclick=function(t){t.preventDefault();var n=el("select.source-type").value;if("raw"===n){var r=el("textarea.raw-input").value,o=JSON.parse(r);e(o)}else{var a=el("label.source-type.url input").value;Loader.get(a,function(t,n){e(n)})}return!1}};controllers.register("ExecuteSourceController",ExecuteSourceController);var controllers=controllers||new Controllers,BarChartController=function(t,e){var n=this;n.container=t,n.chart=Bar(),applyChartConfiguration("chart",t,n.chart,["width","height","identity","duration","style"]),e&&n.update(e)};BarChartController.prototype.update=function(t){var e=this;e.data=t=t||e.data,t&&d3.select(e.container).datum(t).call(e.chart)},controllers.register("BarChart",BarChartController);var controllers=controllers||new Controllers,LineChartController=function(t,e){var n=this;n.container=t,n.chart=Line(),applyChartConfiguration("chart",t,n.chart,["width","height","identity","duration","style"]),e&&n.update(e)};LineChartController.prototype.update=function(t){var e=this;e.data=t=t||e.data,t&&d3.select(e.container).datum(t).call(e.chart)},controllers.register("LineChart",LineChartController);var controllers=controllers||new Controllers,MindMapController=function(t,e){var n=this;n.container=t,n.chart=MindMap(),applyChartConfiguration("mm",t,n.chart,["width","height","identity","duration","style"]),e&&n.update(e),n.dataAttributePrefix="mm"};MindMapController.prototype.update=function(t){var e=this;e.data=t=t||e.data,t&&d3.select(e.container).datum(t).call(e.chart)},controllers.register("MindMap",MindMapController);var controllers=controllers||new Controllers,PieChartController=function(t,e){var n=this;n.container=t,n.chart=Pie(),applyChartConfiguration("chart",t,n.chart,["width","height","identity","duration","style"]),e&&n.update(e)};PieChartController.prototype.update=function(t){var e=this;e.data=t=t||e.data,t&&d3.select(e.container).datum(t).call(e.chart)},controllers.register("PieChart",PieChartController);var controllers=controllers||new Controllers,ScatterChartController=function(t,e){var n=this;n.container=t,n.chart=Scatter(),applyChartConfiguration("chart",t,n.chart,["width","height","identity","duration","style"]),e&&n.update(e)};ScatterChartController.prototype.update=function(t){var e=this;if(e.data=t=t||e.data,t){if(t[0]instanceof Array){var n,r,o,a,i=[],l=t.length;for(n=0;l>n;n++)for(o=t[n].length,r=0;o>r;r++)a=t[n][r],a.x=n,a.y=a.value,i.push(a);t=i}d3.select(e.container).datum(t).call(e.chart)}},controllers.register("ScatterChart",ScatterChartController);var controllers=controllers||new Controllers,TableViewController=function(t,e){var n=this;n.container=t,n.chart=Table(),applyChartConfiguration("table",t,n.chart,["cols","width","height","identity","duration","style"]),n.chart.updated(function(t){t.attr("class","ink-table")}),e&&n.update(e),n.dataAttributePrefix="table"};TableViewController.prototype.update=function(t){var e=this,n=function(t,e){return t&&e instanceof Array};if(e.data=t=t||e.data,t){if(t[0]instanceof Array&&t.reduce(n,!0)){for(tmp=[];t.length;)tmp=tmp.concat(t.shift());t=tmp}d3.select(e.container).datum(t).call(e.chart)}},controllers.register("TableView",TableViewController),function(t){var e=t.partials=new Partials({path:"partials/",ext:".html"}),n=t.Application=function(){var t=this;e.preload(function(){t.init()})};n.prototype.displayPage=function(t,n){var r=t.split("/"),o=r.shift();e.get(t,function(e,r){if(e){var a=new Error(t+": "+e);throw a.page=t,a.source=r,a}try{var i=el("#outlet"),l=el("#"+t).getAttribute("data-controller");o=el("index"===o?'nav li a[href="#home"]':'nav li a[href="#'+(o||"home")+'"]'),i.innerHTML=r(n||{},{helpers:handlebarsHelpers}),l&&controllers.create(i,l,n);var s,u,c=els(i,"[data-controller]"),f=c.length;for(u=0;f>u;u++)s=c[u],l=s.getAttribute("data-controller"),controllers.create(s,l,n)}catch(d){throw d}})},n.prototype.init=function(){var t=this,e=Satnav({html5:!1,force:!0,poll:100});e.navigate({path:"/",directions:function(){t.displayPage("home")}});for(var n=els("script[nav]"),r=0,o=n.length;o>r;r++)e=e.navigate(function(e,n,r){return{path:n,directions:r?function(n){var o=r.replace(/{([^}]+)}/g,function(t,e){return n[e]});Loader.get(o,function(n,r){t.displayPage(e,n||r)})}:function(){t.displayPage(e)}}}(n[r].getAttribute("id"),n[r].getAttribute("nav"),n[r].getAttribute("data-api")));e.change(function(){return t.displayPage("loading"),e.resolve(),this.defer}).otherwise("/"),e.go()};t.app=new n}(this);